# SUPCON å·¥å‚ä»¿çœŸç³»ç»Ÿ v2.0 (ç®€åŒ–ç‰ˆ)

> ä¼ä¸šçº§æ™ºèƒ½åˆ¶é€ ä»¿çœŸå¹³å° - ä¸ºé»‘å®¢æ¾è®¾è®¡çš„ç®€æ´åŸºç¡€ç‰ˆæœ¬

## ğŸ¯ **æ ¸å¿ƒåŠŸèƒ½** 

### âœ… **å·²å®ç°åŠŸèƒ½**
- **å®æ—¶MQTTé€šä¿¡**: ç¨³å®šçš„è®¾å¤‡çŠ¶æ€å‘å¸ƒå’Œå‘½ä»¤æ¥æ”¶
- **æ•…éšœè¯Šæ–­ç³»ç»Ÿ**: åŸºäºPRDè§„èŒƒçš„æ™ºèƒ½æ•…éšœæ³¨å…¥å’Œç»´ä¿®é€»è¾‘
- **Unityå®æ—¶å¯è§†åŒ–**: 100msé«˜é¢‘AGVä½ç½®æ›´æ–°ï¼Œå®æ—¶åŠ¨ç”»äº‹ä»¶
- **åŸºç¡€AGVç³»ç»Ÿ**: ç®€å•è·¯å¾„ç§»åŠ¨å’Œç¢°æ’é¿è®©
- **è®¢å•ç®¡ç†**: è‡ªåŠ¨è®¢å•ç”Ÿæˆå’Œè¿›åº¦è·Ÿè¸ª
- **KPIè®¡ç®—**: å®æ—¶ç”Ÿäº§æ•ˆç‡ã€æˆæœ¬ã€å¯é æ€§ç›‘æ§

### ğŸ”¥ **æ•…éšœç³»ç»Ÿç‰¹è‰²**
- **å®Œæ•´ç»´ä¿®é”å®š**: æ•…éšœæœŸé—´è®¾å¤‡å®Œå…¨æ— æ³•æ“ä½œ
- **é‡å¤ç»´ä¿®é˜²æŠ¤**: ç»´ä¿®æœŸé—´é”å®šï¼Œé˜²æ­¢é‡å¤æ“ä½œ  
- **æ™ºèƒ½è¯Šæ–­é€»è¾‘**: é”™è¯¯è¯Šæ–­æœ‰æ—¶é—´æƒ©ç½šæœºåˆ¶
- **å®æ—¶æ•…éšœè­¦æŠ¥**: å¢å¼ºçš„MQTTæ•…éšœäº‹ä»¶æ¨é€

## ğŸš€ **å¿«é€Ÿå¼€å§‹**

### å®‰è£…ä¾èµ–
```bash
# å®‰è£…uvåŒ…ç®¡ç†å™¨ (å¦‚æœè¿˜æ²¡æœ‰)
curl -LsSf https://astral.sh/uv/install.sh | sh

# å®‰è£…é¡¹ç›®ä¾èµ–
uv sync
```

### è¿è¡ŒåŸºç¡€ä»¿çœŸ
```bash
# è¿è¡ŒåŸºç¡€å·¥å‚ä»¿çœŸç³»ç»Ÿ
uv run src/simulation/factory.py
```

### æµ‹è¯•ç³»ç»Ÿå®Œæ•´æ€§
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
uv run test/run_tests.py
```

## ğŸ“¡ **MQTTæ¥å£**

### è®¾å¤‡çŠ¶æ€ä¸»é¢˜ (æ¯10ç§’)
```
factory/station/{station_id}/status     # å·¥ç«™çŠ¶æ€
factory/agv/{agv_id}/status             # AGVçŠ¶æ€  
factory/status                          # å·¥å‚æ€»ä½“çŠ¶æ€
```

### Unityå®æ—¶å¯è§†åŒ–ä¸»é¢˜ (é«˜é¢‘)
```
factory/realtime/agv/{agv_id}/position     # 100ms AGVä½ç½®
factory/realtime/device/{id}/animation     # è®¾å¤‡åŠ¨ç”»äº‹ä»¶
factory/alerts/{device_id}                 # æ•…éšœè­¦æŠ¥
```

### æ•°æ®æ ¼å¼ç¤ºä¾‹
```json
// AGVä½ç½® (100msæ›´æ–°)
{
  \"agv_id\": \"AGV_1\",
  \"position\": {\"x\": 15.5, \"y\": 20.0, \"z\": 0.0},
  \"rotation\": {\"x\": 0, \"y\": 45, \"z\": 0},
  \"speed\": 2.0,
  \"battery_level\": 85.5
}

// åŠ¨ç”»äº‹ä»¶
{
  \"device_id\": \"StationA\",
  \"animation_type\": \"start_processing\",
  \"duration\": 5.0,
  \"params\": {\"intensity\": 0.8}
}
```

## ğŸ› ï¸ **è®¾å¤‡æ“ä½œæ¥å£**

### åŸºç¡€å‘½ä»¤
```python
# æ£€æŸ¥è®¾å¤‡çŠ¶æ€
factory.inspect_device(\"StationA\")

# è¯·æ±‚ç»´ä¿® (æ•…éšœè¯Šæ–­)
factory.handle_maintenance_request(\"StationA\", \"replace_tool\")

# è·³è¿‡ç»´ä¿®æ—¶é—´ (åŠ é€Ÿæµ‹è¯•)
factory.skip_repair_time(\"StationA\")

# è·å–å¯æ“ä½œè®¾å¤‡åˆ—è¡¨
factory.get_available_devices()
```

### ç»´ä¿®å‘½ä»¤ç±»å‹
```python
ç»´ä¿®ç±»å‹ = [
    \"clean_sensors\",      # æ¸…æ´ä¼ æ„Ÿå™¨
    \"replace_tool\",       # æ›´æ¢å·¥å…·
    \"recalibrate\",        # é‡æ–°æ ¡å‡†
    \"lubricate\",          # æ¶¦æ»‘ä¿å…»
    \"check_alignment\",    # æ£€æŸ¥å¯¹é½
    \"restart_system\"      # é‡å¯ç³»ç»Ÿ
]
```

## ğŸ® **è®¾å¤‡é…ç½®**

### å·¥ç«™é…ç½®
```yaml
stations:
  - id: \"StationA\"
    position: [15, 20]
    buffer_size: 3
    processing_times:
      P1: [30, 45]  # 30-45ç§’å¤„ç†æ—¶é—´
      P2: [40, 60]
      P3: [35, 50]
```

### AGVé…ç½®  
```yaml
agvs:
  - id: \"AGV_1\"
    position: [10, 15]
    speed_mps: 2.0
    battery_level: 100
```

## ğŸ“Š **KPIç›‘æ§**

### è‡ªåŠ¨è®¡ç®—æŒ‡æ ‡
- **ç”Ÿäº§æ•ˆç‡**: è®¢å•å®Œæˆç‡å’Œå¹³å‡å¤„ç†æ—¶é—´
- **æˆæœ¬æ§åˆ¶**: ç»´ä¿®æˆæœ¬å’Œèµ„æºåˆ©ç”¨ç‡
- **ç³»ç»Ÿå¯é æ€§**: æ•…éšœæ¢å¤æ—¶é—´å’Œè®¾å¤‡å¯ç”¨æ€§

### å®æ—¶æ•°æ®å‘å¸ƒ
```
factory/kpi/efficiency    # æ•ˆç‡æŒ‡æ ‡
factory/kpi/cost         # æˆæœ¬æŒ‡æ ‡  
factory/kpi/reliability  # å¯é æ€§æŒ‡æ ‡
```

## ğŸ”§ **æ•…éšœç³»ç»Ÿè¯¦è§£**

### æ•…éšœç±»å‹
```python
æ•…éšœç±»å‹ = [
    \"station_vibration\",      # å·¥ç«™æŒ¯åŠ¨å¼‚å¸¸
    \"precision_degradation\",  # ç²¾åº¦ä¸‹é™
    \"agv_path_blocked\",       # AGVè·¯å¾„é˜»å¡
    \"agv_battery_drain\",      # AGVç”µæ± å¼‚å¸¸æ¶ˆè€—
    \"efficiency_anomaly\"      # æ•ˆç‡å¼‚å¸¸
]
```

### è¯Šæ–­ç»“æœç»“æ„
```python
DiagnosisResult = {
    \"device_id\": str,         # è®¾å¤‡ID
    \"is_correct\": bool,       # è¯Šæ–­æ˜¯å¦æ­£ç¡®
    \"repair_time\": float,     # ç»´ä¿®/æƒ©ç½šæ—¶é—´
    \"penalty_applied\": bool,  # æ˜¯å¦åº”ç”¨æƒ©ç½š
    \"affected_devices\": list, # å—å½±å“çš„è®¾å¤‡
    \"can_skip\": bool         # æ˜¯å¦å¯è·³è¿‡ç­‰å¾…æ—¶é—´
}
```

## ğŸ—ï¸ **ç³»ç»Ÿæ¶æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Unityå‰ç«¯     â”‚â—„â”€â”€â–ºâ”‚   MQTT Broker    â”‚â—„â”€â”€â–ºâ”‚  å·¥å‚ä»¿çœŸåç«¯   â”‚
â”‚  (å¯è§†åŒ–å±•ç¤º)   â”‚    â”‚ (å®æ—¶æ•°æ®é€šä¿¡)   â”‚    â”‚ (ä¸šåŠ¡é€»è¾‘)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–²
                                â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   æ™ºèƒ½ä½“æ¥å£     â”‚
                       â”‚ (å‘½ä»¤å¤„ç†/æ§åˆ¶)  â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ **é¡¹ç›®ç»“æ„**

```
src/
â”œâ”€â”€ simulation/           # æ ¸å¿ƒä»¿çœŸå¼•æ“
â”‚   â”œâ”€â”€ factory.py       # ä¸»å·¥å‚ç±»
â”‚   â””â”€â”€ entities/        # è®¾å¤‡å®ä½“
â”‚       â”œâ”€â”€ station.py   # å·¥ç«™å®ç°
â”‚       â”œâ”€â”€ agv.py       # AGVå®ç°
â”‚       â””â”€â”€ base.py      # è®¾å¤‡åŸºç±»
â”œâ”€â”€ game_logic/          # æ¸¸æˆé€»è¾‘
â”‚   â”œâ”€â”€ fault_system.py  # æ•…éšœç³»ç»Ÿ
â”‚   â”œâ”€â”€ order_generator.py # è®¢å•ç”Ÿæˆ
â”‚   â””â”€â”€ kpi_calculator.py  # KPIè®¡ç®—
â”œâ”€â”€ unity_interface/     # Unityé›†æˆ
â”‚   â””â”€â”€ real_time_publisher.py # å®æ—¶å‘å¸ƒå™¨
â”œâ”€â”€ utils/              # å·¥å…·ç±»
â”‚   â”œâ”€â”€ mqtt_client.py  # MQTTå®¢æˆ·ç«¯
â”‚   â””â”€â”€ config_loader.py # é…ç½®åŠ è½½å™¨
â””â”€â”€ main.py             # ä¸»å…¥å£
```

## ğŸ§ª **æµ‹è¯•å¥—ä»¶**

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run test/run_tests.py

# å•ç‹¬æµ‹è¯•æ¨¡å—
uv run test/test_factory_simulation.py      # åŸºç¡€ä»¿çœŸ
uv run test/test_fault_diagnosis_demo.py    # æ•…éšœè¯Šæ–­  
uv run test/test_interactive_factory.py     # äº¤äº’åŠŸèƒ½
```

## ğŸ¯ **å¼€å‘è§„åˆ’**

### v2.1 è§„åˆ’åŠŸèƒ½
- [ ] Webæ§åˆ¶é¢æ¿
- [ ] æ•°æ®æŒä¹…åŒ–
- [ ] é«˜çº§åˆ†æå·¥å…·
- [ ] å¤šå·¥å‚å®ä¾‹æ”¯æŒ

### é»‘å®¢æ¾å»ºè®®æ–¹å‘
1. **AIæ§åˆ¶å™¨**: åŸºäºçŠ¶æ€ç©ºé—´çš„æ™ºèƒ½å†³ç­–
2. **ä¼˜åŒ–ç®—æ³•**: ç”Ÿäº§è°ƒåº¦å’Œè·¯å¾„ä¼˜åŒ–  
3. **é¢„æµ‹æ€§ç»´æŠ¤**: åŸºäºå†å²æ•°æ®çš„æ•…éšœé¢„æµ‹
4. **å¯è§†åŒ–å¢å¼º**: 3Då»ºæ¨¡å’Œé«˜çº§åŠ¨ç”»
5. **åä½œæœºå™¨äºº**: å¤šæ™ºèƒ½ä½“åè°ƒæ§åˆ¶

## ğŸ¤ **è´¡çŒ®æŒ‡å—**

1. Forké¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/amazing-feature`
3. æäº¤æ›´æ”¹: `git commit -m 'Add amazing feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/amazing-feature`
5. åˆ›å»ºPull Request

## ğŸ“„ **è®¸å¯è¯**

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

**ï¿½ï¿½ ç¥é»‘å®¢æ¾å‚èµ›è€…å–å¾—ä¼˜å¼‚æˆç»©ï¼** 