# SUPCON AdventureX æ™ºèƒ½å·¥å‚ä»¿çœŸ - é€‰æ‰‹ä½¿ç”¨æŒ‡å—

## ä¸€ã€æ¯”èµ›æ¦‚è§ˆ

æ¬¢è¿å‚åŠ  SUPCON AdventureX é»‘å®¢æ¾æ¯”èµ›ï¼ä½ ä»¬å°†è¦å¼€å‘ä¸€ä¸ª AI Agent æ¥æ§åˆ¶å’Œä¼˜åŒ–ä¸€ä¸ªæ™ºèƒ½å·¥å‚çš„è¿è¡Œã€‚

### æ ¸å¿ƒç›®æ ‡
å¼€å‘ä¸€ä¸ª AI Agentï¼Œé€šè¿‡ MQTT åè®®æ¥æ”¶å·¥å‚çŠ¶æ€ä¿¡æ¯ï¼Œåšå‡ºæ™ºèƒ½å†³ç­–ï¼Œå‘é€æ§åˆ¶å‘½ä»¤æ¥ï¼š
- ğŸ“¦ é«˜æ•ˆå®Œæˆç”Ÿäº§è®¢å•
- ğŸ”§ å¿«é€Ÿè¯Šæ–­å¹¶ä¿®å¤è®¾å¤‡æ•…éšœ  
- ğŸ”‹ åˆç†ç®¡ç† AGV å……ç”µå’Œè°ƒåº¦
- ğŸ’° æ§åˆ¶ç”Ÿäº§æˆæœ¬ï¼Œæé«˜æ•ˆç‡

### è¯„åˆ†æ ‡å‡†ï¼ˆæ»¡åˆ† 100 åˆ†ï¼‰
- **ç”Ÿäº§æ•ˆç‡** (40åˆ†): è®¢å•å®Œæˆç‡ã€ç”Ÿäº§å‘¨æœŸã€è®¾å¤‡åˆ©ç”¨ç‡
- **æˆæœ¬æ§åˆ¶** (30åˆ†): ä¸€æ¬¡é€šè¿‡ç‡ã€æ€»ç”Ÿäº§æˆæœ¬
- **AGVæ•ˆç‡** (30åˆ†): å……ç”µç­–ç•¥ã€èƒ½æ•ˆæ¯”ã€åˆ©ç”¨ç‡

## äºŒã€å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£… uv åŒ…ç®¡ç†å™¨
curl -LsSf https://astral.sh/uv/install.sh | sh

# å…‹éš†é¡¹ç›®
git clone <repository_url>
cd 25-SUPCON-AdventureX-Hackthon

# å®‰è£…ä¾èµ–
uv sync
```

### 2. å¯åŠ¨ä»¿çœŸç³»ç»Ÿ

#### æ–°çš„å¤šç»ˆç«¯æ“ä½œæ¨¡å¼ï¼ˆæ¨èï¼‰

ä¸ºäº†æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å°†ä»¿çœŸç³»ç»Ÿçš„æç¤ºä¿¡æ¯å’Œæ“ä½œæ§åˆ¶åˆ†ç¦»åˆ°ä¸åŒçš„ç»ˆç«¯çª—å£ã€‚

è¯·æ‰“å¼€ **3ä¸ªç»ˆç«¯çª—å£**ï¼Œåˆ†åˆ«è¿è¡Œï¼š

**ç»ˆç«¯ 1 - ä¸»ä»¿çœŸç¨‹åº**
```bash
uv run run_simulation.py
# æˆ–ç¦ç”¨æ•…éšœç³»ç»Ÿ
uv run run_simulation.py --no-faults
```

**ç»ˆç«¯ 2 - ç›‘æ§ç»ˆç«¯**
```bash
uv run monitor_simulation.py
```
- å®æ—¶æ˜¾ç¤ºä»¿çœŸçŠ¶æ€ã€æ•…éšœè­¦æŠ¥ã€KPIæŒ‡æ ‡
- å®šæœŸæ˜¾ç¤ºæ¸¸æˆæç¤ºï¼Œå¸®åŠ©ä¼˜åŒ–ç­–ç•¥

**ç»ˆç«¯ 3 - æ§åˆ¶ç»ˆç«¯**
```bash
uv run control_simulation.py
```
- æä¾›å‹å¥½çš„äº¤äº’å¼èœå•
- æ§åˆ¶AGVç§»åŠ¨ã€è£…è½½ã€å¸è½½ã€å……ç”µ

#### ä¼ ç»Ÿå•ç»ˆç«¯æ¨¡å¼
```bash
# å¯åŠ¨å¹¶å¼€å¯æ‰‹åŠ¨æ§åˆ¶èœå•ï¼ˆå·²åºŸå¼ƒï¼Œå»ºè®®ä½¿ç”¨å¤šç»ˆç«¯æ¨¡å¼ï¼‰
uv run run_simulation.py --menu
```

### 3. ä½“éªŒäº¤äº’å¼æµ‹è¯•

```bash
# è¿è¡Œäº¤äº’å¼ä½“éªŒï¼Œäº†è§£ç³»ç»Ÿè¿ä½œ
uv run test/test_interactive_factory.py
```

## ä¸‰ã€å·¥å‚ç³»ç»Ÿè¯´æ˜

### ç”Ÿäº§æµç¨‹

```
åŸæ–™ä»“åº“ â†’ [AGVè¿è¾“] â†’ å·¥ç«™A â†’ [ä¼ é€å¸¦] â†’ å·¥ç«™B â†’ [ä¼ é€å¸¦] â†’ å·¥ç«™C â†’ [ä¼ é€å¸¦] â†’ è´¨æ£€ç«™ â†’ [AGVè¿è¾“] â†’ æˆå“ä»“åº“
```

ç‰¹æ®Šæµç¨‹ï¼šP3äº§å“éœ€è¦åœ¨å·¥ç«™Cåè¿”å›å·¥ç«™Bè¿›è¡ŒäºŒæ¬¡åŠ å·¥

### è®¾å¤‡é…ç½®

| è®¾å¤‡ | ID | åŠŸèƒ½ | ç¼“å†²åŒº |
|------|-----|------|--------|
| å·¥ç«™A | StationA | åˆçº§åŠ å·¥ | 3ä¸ªä½ç½® |
| å·¥ç«™B | StationB | ç²¾å¯†åŠ å·¥ | 3ä¸ªä½ç½® |
| å·¥ç«™C | StationC | æµ‹è¯• | 3ä¸ªä½ç½® |
| è´¨æ£€ç«™ | QualityCheck | è´¨é‡æ£€æµ‹ | è¾“å…¥2ä¸ªï¼Œè¾“å‡º3ä¸ª |
| AGV_1 | AGV_1 | ä¸‹æ–¹è¿è¾“ï¼ˆy<20ï¼‰ | è½½é‡2ä¸ª |
| AGV_2 | AGV_2 | ä¸Šæ–¹è¿è¾“ï¼ˆy>20ï¼‰ | è½½é‡2ä¸ª |

### äº§å“ç±»å‹

- **P1** (60%): æ ‡å‡†äº§å“ï¼Œå¸¸è§„æµç¨‹
- **P2** (30%): é«˜ç²¾åº¦äº§å“ï¼Œå¤„ç†æ—¶é—´è¾ƒé•¿
- **P3** (10%): å¤æ‚äº§å“ï¼Œéœ€è¦äºŒæ¬¡åŠ å·¥

## å››ã€MQTT é€šä¿¡æ¥å£

### è¿æ¥é…ç½®

```python
MQTT_BROKER_HOST = "localhost"
MQTT_BROKER_PORT = 1883
CLIENT_ID = "agent_player_001"  # è‡ªå®šä¹‰ä½ çš„ Agent ID
```

### è®¢é˜…ä¸»é¢˜ï¼ˆæ¥æ”¶ä¿¡æ¯ï¼‰

#### 1. è®¾å¤‡çŠ¶æ€ï¼ˆæ¯10ç§’æ›´æ–°ï¼‰
```
# å·¥ç«™çŠ¶æ€
NLDF1/line1/station/{station_id}/status
NLDF1/line1/conveyor/{conveyor_id}/status
NLDF1/line1/resource/{agv_id}/status
NLDF1/line1/warehouse/{warehouse_id}/status
```

çŠ¶æ€æ¶ˆæ¯ç¤ºä¾‹ï¼š
```json
{
  "device_id": "StationA",
  "status": "processing",  // idle, processing, block, fault
  "buffer_level": 2,
  "buffer_capacity": 3,
  "current_product": "PROD_001_P1",
  "processing_time_left": 15.5,
  "symptom": null  // æ•…éšœæ—¶æ˜¾ç¤ºç—‡çŠ¶
}
```

#### 2. è­¦æŠ¥ä¸»é¢˜
```
# ç¼“å†²åŒºæ»¡è­¦æŠ¥
NLDF1/line1/alerts/buffer_full

# AGVä½ç”µé‡è­¦æŠ¥
NLDF1/line1/alerts/agv_battery_low
```

#### 3. è®¢å•ä¿¡æ¯
```
# æ–°è®¢å•
NLDF1/line1/orders/new
```

è®¢å•æ¶ˆæ¯ç¤ºä¾‹ï¼š
```json
{
  "order_id": "ORDER_001",
  "product_type": "P1",
  "quantity": 3,
  "priority": "high",
  "deadline": 1234567890.123,
  "created_at": 1234567000.123
}
```

#### 4. KPI æ›´æ–°ï¼ˆæ¯10ç§’ï¼‰
```
NLDF1/line1/kpi/update
```

### å‘å¸ƒä¸»é¢˜ï¼ˆå‘é€å‘½ä»¤ï¼‰

#### å‘½ä»¤ä¸»é¢˜
```
NLDF1/line1/agent/commands
```

#### å‘½ä»¤æ ¼å¼

1. **AGV ç§»åŠ¨**
```json
{
  "command_id": "cmd_001",
  "action": "move",
  "target": "AGV_1",
  "params": {
    "destination_id": "P3"  // P0-P10 è·¯å¾„ç‚¹
  }
}
```

2. **AGV è£…è½½**
```json
{
  "action": "load",
  "target": "AGV_1", 
  "params": {
    "source_station_id": "StationA"
  }
}
```

3. **AGV å¸è½½**
```json
{
  "action": "unload",
  "target": "AGV_1",
  "params": {
    "target_station_id": "StationB"
  }
}
```

4. **AGV å……ç”µ**
```json
{
  "action": "charge",
  "target": "AGV_1",
  "params": {}
}
```

## äº”ã€AGV è·¯å¾„ç‚¹è¯´æ˜

### AGV_1 è·¯å¾„ç‚¹ï¼ˆä¸‹æ–¹è·¯çº¿ï¼‰
- P0: [5, 15] - åŸæ–™ä»“åº“
- P1: [12, 15] - å·¥ç«™A
- P3: [32, 15] - å·¥ç«™B
- P5: [52, 15] - å·¥ç«™C
- P7: [72, 15] - è´¨æ£€ç«™ï¼ˆè¾“å…¥ï¼‰
- P8: [80, 15] - è´¨æ£€ç«™ï¼ˆè¾“å‡ºï¼‰
- P9: [95, 15] - æˆå“ä»“åº“
- P10: [10, 10] - å……ç”µç«™

### AGV_2 è·¯å¾„ç‚¹ï¼ˆä¸Šæ–¹è·¯çº¿ï¼‰
- P0: [5, 25] - åŸæ–™ä»“åº“
- P1: [12, 25] - å·¥ç«™A
- P3: [32, 25] - å·¥ç«™B
- P5: [52, 25] - å·¥ç«™C
- P7: [72, 25] - è´¨æ£€ç«™ï¼ˆè¾“å…¥ï¼‰
- P8: [80, 25] - è´¨æ£€ç«™ï¼ˆè¾“å‡ºï¼‰
- P9: [95, 25] - æˆå“ä»“åº“
- P10: [10, 30] - å……ç”µç«™

## å…­ã€æ•…éšœè¯Šæ–­ç³»ç»Ÿ

### æ•…éšœç±»å‹ä¸ç—‡çŠ¶

å·¥å‚è®¾å¤‡ä¼šéšæœºå‡ºç°æ•…éšœï¼Œéœ€è¦æ­£ç¡®è¯Šæ–­å¹¶ä¿®å¤ï¼š

| æ•…éšœç±»å‹ | å¯èƒ½åŸå›  | æ­£ç¡®ä¿®å¤å‘½ä»¤ |
|---------|---------|-------------|
| station_vibration | è½´æ‰¿ç£¨æŸ/èºæ “æ¾åŠ¨ | replace_bearing/tighten_bolts |
| precision_degradation | åˆ€å…·é’åŒ–/æ ¡å‡†åç§» | replace_tool/recalibrate |
| agv_path_blocked | ä¸´æ—¶éšœç¢/å®šä½æ•…éšœ | reroute_agv/reboot_device |
| agv_battery_drain | ç”µæ± è€åŒ–/é«˜è´Ÿè½½ä»»åŠ¡ | force_charge/optimize_schedule |
| efficiency_anomaly | è½¯ä»¶è¿‡çƒ­/æ¶¦æ»‘ä¸è¶³ | reduce_frequency/add_lubricant |

### è¯Šæ–­æµç¨‹

1. ç›‘å¬æ•…éšœè­¦æŠ¥
2. åˆ†ææ•…éšœç—‡çŠ¶
3. å‘é€æ­£ç¡®çš„ä¿®å¤å‘½ä»¤
4. æ­£ç¡®è¯Šæ–­è·å¾—åŸºç¡€ä¿®å¤æ—¶é—´ï¼Œé”™è¯¯è¯Šæ–­ä¼šæœ‰æ—¶é—´æƒ©ç½š

## ä¸ƒã€AGV ç”µé‡ç®¡ç†

### ç”µé‡æ¶ˆè€—
- ç§»åŠ¨ï¼š0.1%/ç±³
- è£…è½½/å¸è½½ï¼š0.5%/æ¬¡
- é™æ­¢ï¼š0%

### å……ç”µæœºåˆ¶
- å……ç”µé€Ÿåº¦ï¼š3.33%/ç§’ï¼ˆ30ç§’å……æ»¡ï¼‰
- ä½ç”µé‡é˜ˆå€¼ï¼š5%ï¼ˆå¼ºåˆ¶è¿”èˆªå……ç”µï¼‰
- å»ºè®®åœ¨ 20% æ—¶ä¸»åŠ¨å……ç”µé¿å…æƒ©ç½š

## å…«ã€å¼€å‘å»ºè®®

### 1. åŸºç¡€æ¡†æ¶ç¤ºä¾‹

```python
import json
import paho.mqtt.client as mqtt
from typing import Dict, List

class FactoryAgent:
    def __init__(self):
        self.client = mqtt.Client("agent_player_001")
        self.factory_state = {}
        self.active_orders = []
        
    def on_connect(self, client, userdata, flags, rc):
        # è®¢é˜…æ‰€æœ‰éœ€è¦çš„ä¸»é¢˜
        client.subscribe("NLDF1/line1/station/+/status")
        client.subscribe("NLDF1/line1/resource/+/status")
        client.subscribe("NLDF1/line1/orders/new")
        client.subscribe("NLDF1/line1/alerts/+")
        
    def on_message(self, client, userdata, msg):
        topic = msg.topic
        data = json.loads(msg.payload.decode())
        
        # æ›´æ–°çŠ¶æ€
        if "/status" in topic:
            self.update_device_status(topic, data)
        elif "/orders/new" in topic:
            self.handle_new_order(data)
        elif "/alerts/" in topic:
            self.handle_alert(topic, data)
            
    def send_command(self, action: str, target: str, params: dict):
        command = {
            "action": action,
            "target": target,
            "params": params
        }
        self.client.publish("NLDF1/line1/agent/commands", json.dumps(command))
```

### 2. ç­–ç•¥å»ºè®®

#### åˆçº§ç­–ç•¥
1. ç›‘æ§æ‰€æœ‰è®¾å¤‡çŠ¶æ€
2. å½“åŸæ–™ä»“åº“æœ‰ææ–™æ—¶ï¼Œæ´¾ AGV è¿è¾“åˆ°å·¥ç«™A
3. ç›‘æ§ç¼“å†²åŒºï¼Œé¿å…æº¢å‡º
4. AGV ç”µé‡ä½äº 20% æ—¶ä¸»åŠ¨å……ç”µ

#### è¿›é˜¶ç­–ç•¥
1. æ ¹æ®è®¢å•ä¼˜å…ˆçº§è°ƒåº¦ç”Ÿäº§
2. é¢„æµ‹è®¾å¤‡æ•…éšœï¼Œæå‰ç»´æŠ¤
3. ä¼˜åŒ– AGV è·¯å¾„ï¼Œå‡å°‘ç©ºè½½è¡Œé©¶
4. åŠ¨æ€è°ƒæ•´ç”Ÿäº§èŠ‚å¥ï¼Œå¹³è¡¡æ•ˆç‡å’Œæˆæœ¬

#### é«˜çº§ç­–ç•¥
1. å®ç°å¤šè®¢å•å¹¶è¡Œå¤„ç†
2. å»ºç«‹æ•…éšœè¯Šæ–­çŸ¥è¯†åº“
3. ä½¿ç”¨å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–å†³ç­–
4. é¢„æµ‹æ€§ç»´æŠ¤å’Œèµ„æºåˆ†é…

### 3. è°ƒè¯•æŠ€å·§

```bash
# ç›‘æ§æ‰€æœ‰ MQTT æ¶ˆæ¯
mosquitto_sub -h localhost -t '#' -v

# æ‰‹åŠ¨å‘é€æµ‹è¯•å‘½ä»¤
mosquitto_pub -h localhost -t 'NLDF1/line1/agent/commands' -m '{"action":"move","target":"AGV_1","params":{"destination_id":"P1"}}'
```

## ä¹ã€å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å¤„ç†ç¼“å†²åŒºæ»¡çš„æƒ…å†µï¼Ÿ
A: ç›‘å¬ buffer_full è­¦æŠ¥ï¼ŒåŠæ—¶æ´¾ AGV æ¸…ç©ºç¼“å†²åŒºæˆ–æš‚åœä¸Šæ¸¸ç”Ÿäº§ã€‚

### Q: AGV å……ç”µæ—¶æœºå¦‚ä½•é€‰æ‹©ï¼Ÿ
A: å»ºè®®åœ¨è®¢å•é—´éš™æˆ–ç”Ÿäº§ä½å³°æœŸä¸»åŠ¨å……ç”µï¼Œé¿å…è¢«åŠ¨å……ç”µçš„æƒ©ç½šã€‚

### Q: å¦‚ä½•æé«˜è´¨æ£€é€šè¿‡ç‡ï¼Ÿ
A: ç¡®ä¿äº§å“æŒ‰æ­£ç¡®æµç¨‹ç”Ÿäº§ï¼ŒP3äº§å“å¿…é¡»å®ŒæˆäºŒæ¬¡åŠ å·¥ã€‚

### Q: æ•…éšœè¯Šæ–­æ€»æ˜¯å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
A: ä»”ç»†åˆ†ææ•…éšœç—‡çŠ¶ï¼Œå‚è€ƒæ•…éšœè¯Šæ–­æ‰‹å†Œï¼Œå»ºç«‹ç—‡çŠ¶åˆ°ä¿®å¤å‘½ä»¤çš„æ˜ å°„ã€‚

## åã€æäº¤è¦æ±‚

1. **Docker é•œåƒ**ï¼šå°†ä½ çš„ Agent æ‰“åŒ…æˆ Docker é•œåƒ
2. **æ–‡æ¡£**ï¼šåŒ…å«æ¶æ„è¯´æ˜å’Œä½¿ç”¨æ–¹æ³•
3. **æºä»£ç **ï¼šå®Œæ•´çš„ Agent å®ç°ä»£ç 

### Dockerfile ç¤ºä¾‹

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

CMD ["python", "agent.py"]
```

## ç¥ä½ åœ¨æ¯”èµ›ä¸­å–å¾—ä¼˜å¼‚æˆç»©ï¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿã€‚è®°ä½ï¼šé«˜æ•ˆã€æ™ºèƒ½ã€é²æ£’æ˜¯è·èƒœçš„å…³é”®ï¼